Template Version: 2025.11.13
## Pre-2K:
GitHub: https://github.com/garrettfoster13/pre2k 
Pre2K: `pre2k unauth -d <domain> -dc-ip <dc_ip> -inputfile users.txt`
NetExec: `netexec ldap <domain> -u <user> -p <pass> -M pre2k`

---
### BloodHound:
#### Collection:
###### Main AD Objects:
**User/pass:** `bloodhound-ce-python -u <user> -d <domain> -c all -v -ns <IP> --zip`
**Kerberos:** `bloodhound-ce-python -u <user> -k -no-pass -d <domain> -c all -v -ns <IP> --zip`
**SharpHound:** `.\sharphound.exe --CollectionMethods All`
**Note:** May need adding machine name for DC to `/etc/hosts`. May need `faketime`. Alternatively use SharpHound.
###### Certipy ADCS (per account):
**User/pass:** `certipy-ad find -username <user>@<domain.tld> -password <pass> -dc-ip <IP> -ldap-scheme <ldap/ldaps>`
**Kerberos:** `certipy-ad find -username <user>@<domain.tld> -no-pass -k -dc-ip <IP> -target <DC>`
**Netexec check:** `netexec ldap <domain> -u <user> -p <pass> -M adcs`

---
#### Initialize:
**Neo4J (optional):** `sudo neo4j console`
* User: `neo4j`; Password: root user
**Bloodhound:** `bloodhound`
- User: `admin`; Password: `BloodHound@<YYMM>` (Nov 25)
- Web UI: `localhost:8080`

---
### Roasting:
#### Kerberoasting:
###### Commands:
- **LDAPSearch:** `ldapsearch -x -H ldap://<DC> -D "<user>@<domain>" -w "<pass>" -b "dc=<domain>,dc=<tld>" "(servicePrincipalName=*)" sAMAccountName servicePrincipalName`
- **CMD:** `setspn -Q */* | findstr /V "$" | findstr /C:"Users"`
- **PowerShell:** `Get-ADUser -Filter {ServicePrincipalName -like "*"} -Properties ServicePrincipalName | Select-Object SamAccountName`
- **Exploitation:** see *Kerberos Template*.
###### Roastable Users:

#### AS-REP Roasting:
###### Commands:
- **LDAPSearch:** `ldapsearch -x -H ldap://<DC> -D <user>@<domain -w <pass> -b "dc=<domain>,dc=<tld>" "(userAccountControl:1.2.840.113556.1.4.803:=4194304)" sAMAccountName`
- **PowerShell:** `Get-ADUser -Filter {DoesNotRequirePreAuth -eq $true} -Properties DoesNotRequirePreAuth | Select-Object SamAccountName`
- **Exploitation:** see *Kerberos Template*.
###### Roastable Users:

---
### Users:
- `Get-ObjectAcl -Identity <user>`

---
### Service Accounts:

---
### Cypher Queries:
###### Kerberoastables:

---
### Machines:

---